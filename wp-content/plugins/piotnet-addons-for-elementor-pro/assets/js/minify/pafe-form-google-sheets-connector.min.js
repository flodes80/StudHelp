jQuery(document).ready(function(e){function t(e){var t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],o=e.slice(0,1).toUpperCase(),n=e.slice(1,2).toUpperCase();return""==n?t.indexOf(o):26*(t.indexOf(o)+1)+t.indexOf(n)}e(document).on("submit","[data-pafe-form-google-sheets-connector] form",function(){var o=e(this).closest("[data-pafe-form-google-sheets-connector]"),n=[];e(this).find('[name^="form_fields"]').each(function(){var t=e(this).attr("type"),o=e(this).attr("name");if(-1!==o.indexOf("[]")){var a=[];if("checkbox"==t)e(document).find('[name="'+o+'"]:checked').each(function(){a.push(e(this).val())});else if(null==(a=e(this).val()))var a=[];r="";for(var s=0;s<a.length;s++)r+=a[s],s!=a.length-1&&(r+=",")}else if("radio"==t||"checkbox"==t)var r=e(document).find('[name="'+o+'"]:checked').val();else var r=e(this).val().trim();if(void 0!=r){var i={};i.name=o.replace("[]","").replace("form_fields[","").replace("]",""),i.value=r,n.push(i)}});for(var a="",s=o.data("pafe-form-google-sheets-connector-field-list"),r=[],i=0;i<s.length;i++)r.push(t(s[i].pafe_form_google_sheets_connector_field_column));for(var l=0;l<Math.max.apply(null,r)+1;l++){for(var c="",i=0;i<s.length;i++){var f=s[i].pafe_form_google_sheets_connector_field_id;if(l==t(s[i].pafe_form_google_sheets_connector_field_column))for(var p=0;p<n.length;++p)n[p].name==f&&(c=n[p].value)}a+='"'+c+'",'}a=a.slice(0,-1);var d=o.data("pafe-form-google-sheets-connector"),h=o.data("pafe-form-google-sheets-connector-clid"),u=o.data("pafe-form-google-sheets-connector-clis"),m=o.data("pafe-form-google-sheets-connector-rtok"),g="https://sheets.googleapis.com/v4/spreadsheets/"+d+"/values/A1:append?includeValuesInResponse=false&insertDataOption=INSERT_ROWS&responseDateTimeRenderOption=SERIAL_NUMBER&responseValueRenderOption=FORMATTED_VALUE&valueInputOption=USER_ENTERED",_='{"majorDimension":"ROWS", "values":[['+a+"]]}",v=new XMLHttpRequest;v.open("POST","https://www.googleapis.com/oauth2/v4/token?client_id="+h+"&client_secret="+u+"&refresh_token="+m+"&grant_type=refresh_token"),v.setRequestHeader("Content-type","application/x-www-form-urlencoded"),v.onload=function(){var e=JSON.parse(v.responseText),t=e.access_token;if(t){var o=new XMLHttpRequest;o.open("POST",g),o.setRequestHeader("Content-length",_.length),o.setRequestHeader("Content-type","application/json"),o.setRequestHeader("Authorization","OAuth "+t),o.send(_)}},v.send()})});